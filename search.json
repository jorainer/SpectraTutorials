[{"path":"https://jorainer.github.io/SpectraTutorials/Abstract-EuroBioc2020.html","id":null,"dir":"","previous_headings":"","what":"Abstract","title":"Abstract","text":"Mass spectrometry (MS) data key technology modern proteomics metabolomics experiments. Due continuous improvements MS instrumentation, generated data can easily become large. Also, different additional resources MS data exist, spectra libraries databases, specific file formats sometimes support manipulations original data. Learning experiences r Biocpkg(\"MSnbase\") Bioconductor package developed novel infrastructure handle MS spectral data R, r Biocpkg(\"Spectra\") package. package implements clear separation user functionality code provide, store import mass spectrometry data. Different backends can hence used enable access data various data resources designed specifically large MS data sets. Data manipulations default directly applied data cached lazy processing queue allows analyses also read-data representations. workshop shows expandability new infrastructure enable seamless integration analysis MS data variety input formats illustrated simple matching experimental MS2 spectra public spectral database export data format commonly used exchange MS2 data.","code":""},{"path":"https://jorainer.github.io/SpectraTutorials/Abstract-EuroBioc2022.html","id":null,"dir":"","previous_headings":"","what":"Abstract","title":"Abstract","text":"Mass spectrometry (MS) data key technology modern proteomics metabolomics experiments. Due continuous improvements MS instrumentation, generated data can easily become large. Also, different additional resources MS data exist, spectra libraries databases, specific file formats sometimes support manipulations original data. Learning experiences r Biocpkg(\"MSnbase\") Bioconductor package developed novel infrastructure handle MS spectral data R, r Biocpkg(\"Spectra\") package. package implements clear separation user functionality code provide, store import mass spectrometry data. Different backends can hence used enable access data various data resources. Depending backend, data representations can memory, disk, local remote. Data manipulations default directly applied data cached lazy processing queue allows analyses also read-data representations. workshop shows new infrastructure can used integrate data variety different input sources simple example fragment (MS2) spectra experiment matched reference MS2 spectra public spectral library. Results finally exported format commonly used exchange MS2 data.","code":""},{"path":"https://jorainer.github.io/SpectraTutorials/Abstract-EuroBioc2023.html","id":null,"dir":"","previous_headings":"","what":"Spectra: an expandable infrastructure to handle mass spectrometry data","title":"Spectra: an expandable infrastructure to handle mass spectrometry data","text":"Mass spectrometry (MS) data key technology modern metabolomics proteomics experiments. Continuous improvements MS instrumentation, larger experiments new technological developments lead ever growing data sizes increased number available variables making standard -memory data handling processing difficult. Spectra package provides modern infrastructure MS data handling specifically designed enable extension additional data resources alternative data representations. can realized extending virtual MsBackend class related methods. Implementations MsBackend classes can tailored specific needs, low memory footprint, fast processing, remote data access, also support specific additional data types variables. Importantly, data processing Spectra objects independent backend use due lazy evaluation mechanism caches data manipulations internally. workshop discusses different available data representations MS data along properties, advantages performances. addition, Spectra’s concept lazy evaluation data manipulations presented, well simple caching mechanism data modifications. Finally, explains new MsBackend instances can implemented tested ensure compliance. Describe: - Concept backends. - Loading MS data. - Backends, -disk, -memory. - Using MsBackendSql store data. - Use MsBackendMassbankSql access data: parallel processing possible. - Different properties backends. - Lazy processing caching.","code":""},{"path":[]},{"path":"https://jorainer.github.io/SpectraTutorials/articles/Spectra-matching-with-MetaboAnnotation.html","id":"introduction","dir":"Articles","previous_headings":"Overview","what":"Introduction","title":"MS/MS Spectra Matching with the `MetaboAnnotation` Package","text":"Spectra package provides functionality required annotation identification workflows untargeted LC-MS/MS data, , flexible customizable, might cumbersome beginners analysts accustomed R. fill gap developed MetaboAnnotation package builds upon Spectra provides functions annotation LC-MS LC-MS/MS data sets tailored towards less experienced R user (Rainer et al. 2022).","code":""},{"path":"https://jorainer.github.io/SpectraTutorials/articles/Spectra-matching-with-MetaboAnnotation.html","id":"convenient-spectra-matching-using-metaboannotation","dir":"Articles","previous_headings":"Overview","what":"Convenient spectra matching using MetaboAnnotation","title":"MS/MS Spectra Matching with the `MetaboAnnotation` Package","text":"example use case match experimental MS2 spectra DDA experiment pesticide mix reference spectra MassBank. load experimental data file distributed via msdata R package. next restrict data set MS2 spectra addition clean spectra removing peaks spectrum intensity lower 5% largest peak intensity spectrum. Finally, single-peak spectra removed. leads data set consisting 2451 spectra. next connect MassBank database (running within docker image) create Spectra object representing data. Alternatively, MySQL database system available tutorial can run within docker, SQLite database version MassBank data (format required MsBackendMassbankSql available . downloading database MassbankSql-2021-03.db current R workspace, resource can loaded : now directly calculate similarities 2451 experimental (query) MS2 spectra 86576 MassBank reference (target) spectra using compareSpectra method, computationally intense similarity score calculated query target spectrum. alternative use matchSpectra function MetaboAnnotation package allows restrict similarity calculations query target spectra similar m/z precursor ion similar retention time. create CompareSpectraParam object setting parameter requirePrecursor = TRUE (restrict similarity calculations query target spectra similar precursor m/z) ppm = 10 (m/z difference query target precursor within 10 ppm). Parameter THRESHFUN enables define threshold function defines spectra considered matching. function used MS2 spectra similarity (calculated default dotproduct function) larger equal 0.8 considered matching. next call matchSpectra parameter object pass pest mbank query target Spectra, respectively. takes approximately 1 minute complete, tremendously fast, still much faster pairwise comparison query target spectra . result get MatchedSpectra object contains query target spectra well matching result (.e. information query spectrum matches target spectrum based similarity score). can use query target functions access query target Spectra objects matches extract matching information. display first 6 rows matrix. Functions whichQuery whichTarget return (unique) indices query target spectra matched. can see query spectra (29 2451 spectra) matched. part large proportion spectra MassBank precursor m/z available requirePrecursor = TRUE considered similarity calculation. Setting requirePrecursor = FALSE calculate similarity spectra (even missing precursor information) calculations can take several hours. MatchedSpectra object inherits much functionality Spectra object. spectraVariables returns example available spectra variables, query well target Spectra. variable names latter prefixed target_ discriminate variable names query. can access spectra individual variables using $ variable name, multiple variables spectraData function. extract retention time, precursor m/z query spectrum, precursor m/z target spectrum well similarity score object using spectraData function. returned DataFrame contains matching information full data set, .e. query spectrum hence, returns NA values query spectra matched target spectrum. Note also query spectra matching multiple target spectra represented multiple rows (one matching target spectrum). ’re interested query spectra match found thus subset MatchedSpectra query spectra matching target spectrum. Subsetting MatchedSpectra always relative query, .e. subsetting object index 4 restrict object matching results 4th query spectrum. now extract matching information subsetting: can also return compound names matching spectra. matchSpectra enables thus perform convenient spectra matching MS data represented Spectra objects. result, MatchedSpectra object returned , addition matching results, contains also query target spectra. Pre-filtering spectra prior actual spectra similarity calculation can reduce running time matchSpectra call might also miss potential matches. Note addition precursor m/z-based pre-filter also retention time pre-filtering available (see ?matchSpectra information). Also, advanced matching approach available MatchForwardReverseParam calculates addition forward score also reverse similarity match.","code":"library(Spectra) library(pander)  #' Load the pesticide mix data fl <- system.file(\"TripleTOF-SWATH\", \"PestMix1_DDA.mzML\", package = \"msdata\") pest <- Spectra(fl) #' restrict to MS2 data and remove intensities with intensity lower 5% pest <- filterMsLevel(pest, msLevel = 2L)  #' Remove peaks with an intensity below 5% or the spectra's BPC low_int <- function(x, ...) {     x > max(x, na.rm = TRUE) * 0.05 } pest <- filterIntensity(pest, intensity = low_int)  #' Remove peaks with a single peak pest <- pest[lengths(pest) > 1] library(RMariaDB) library(MsBackendMassbank)  #' Connect to the MassBank MySQL database con <- dbConnect(MariaDB(), user = \"massbank\", dbname = \"MassBank\",                  host = \"localhost\", pass = \"massbank\") mbank <- Spectra(con, source = MsBackendMassbankSql()) ## Alternative to the MySQL server - assuming the SQLite database was ## stored to the R working directory. library(RSQLite) library(MsBackendMassbank) con <- dbConnect(SQLite(), \"MassbankSql-2021-03.db\") mbank <- Spectra(con, source = MsBackendMassbankSql()) library(MetaboAnnotation) prm <- CompareSpectraParam(ppm = 10, requirePrecursor = TRUE,                            THRESHFUN = function(x) which(x >= 0.8)) mtch <- matchSpectra(pest, mbank, param = prm) mtch ## Object of class MatchedSpectra  ## Total number of matches: 78  ## Number of query objects: 2451 (29 matched) ## Number of target objects: 86576 (47 matched) head(matches(mtch)) ##   query_idx target_idx     score ## 1       163      31941 0.9264249 ## 2       163      32022 0.9264249 ## 3       163      32214 0.9264249 ## 4       163      32508 0.9264249 ## 5       163      32667 0.9264249 ## 6       163      32900 0.9264249 whichQuery(mtch) ##  [1]  163  320  420  433  493  496  497  571  682  685  686  805  806  809  810 ## [16]  819  829  983 1095 1454 1457 1706 1830 1834 1839 1906 2047 2048 2050 sum(is.na(precursorMz(mbank))) ## [1] 24498 spectraVariables(mtch) ##  [1] \"msLevel\"                        \"rtime\"                          ##  [3] \"acquisitionNum\"                 \"scanIndex\"                      ##  [5] \"dataStorage\"                    \"dataOrigin\"                     ##  [7] \"centroided\"                     \"smoothed\"                       ##  [9] \"polarity\"                       \"precScanNum\"                    ## [11] \"precursorMz\"                    \"precursorIntensity\"             ## [13] \"precursorCharge\"                \"collisionEnergy\"                ## [15] \"isolationWindowLowerMz\"         \"isolationWindowTargetMz\"        ## [17] \"isolationWindowUpperMz\"         \"peaksCount\"                     ## [19] \"totIonCurrent\"                  \"basePeakMZ\"                     ## [21] \"basePeakIntensity\"              \"ionisationEnergy\"               ## [23] \"lowMZ\"                          \"highMZ\"                         ## [25] \"mergedScan\"                     \"mergedResultScanNum\"            ## [27] \"mergedResultStartScanNum\"       \"mergedResultEndScanNum\"         ## [29] \"injectionTime\"                  \"filterString\"                   ## [31] \"spectrumId\"                     \"ionMobilityDriftTime\"           ## [33] \"scanWindowLowerLimit\"           \"scanWindowUpperLimit\"           ## [35] \"target_msLevel\"                 \"target_rtime\"                   ## [37] \"target_acquisitionNum\"          \"target_scanIndex\"               ## [39] \"target_dataStorage\"             \"target_dataOrigin\"              ## [41] \"target_centroided\"              \"target_smoothed\"                ## [43] \"target_polarity\"                \"target_precScanNum\"             ## [45] \"target_precursorMz\"             \"target_precursorIntensity\"      ## [47] \"target_precursorCharge\"         \"target_collisionEnergy\"         ## [49] \"target_isolationWindowLowerMz\"  \"target_isolationWindowTargetMz\" ## [51] \"target_isolationWindowUpperMz\"  \"target_spectrum_id\"             ## [53] \"target_spectrum_name\"           \"target_date\"                    ## [55] \"target_authors\"                 \"target_license\"                 ## [57] \"target_copyright\"               \"target_publication\"             ## [59] \"target_splash\"                  \"target_compound_id\"             ## [61] \"target_adduct\"                  \"target_ionization\"              ## [63] \"target_ionization_voltage\"      \"target_fragmentation_mode\"      ## [65] \"target_collision_energy_text\"   \"target_instrument\"              ## [67] \"target_instrument_type\"         \"target_formula\"                 ## [69] \"target_exactmass\"               \"target_smiles\"                  ## [71] \"target_inchi\"                   \"target_inchikey\"                ## [73] \"target_cas\"                     \"target_pubchem\"                 ## [75] \"target_synonym\"                 \"target_precursor_mz_text\"       ## [77] \"target_compound_name\"           \"score\" spectraData(mtch, c(\"rtime\", \"precursorMz\", \"target_precursorMz\", \"score\")) ## DataFrame with 2500 rows and 4 columns ##          rtime precursorMz target_precursorMz     score ##      <numeric>   <numeric>          <numeric> <numeric> ## 1        7.216    137.9639                 NA        NA ## 2       13.146     56.9419                 NA        NA ## 3       13.556     89.9449                 NA        NA ## 4       23.085    207.0294                 NA        NA ## 5       27.385    121.0990                 NA        NA ## ...        ...         ...                ...       ... ## 2496   895.182    137.9850                 NA        NA ## 2497   895.472     56.0495                 NA        NA ## 2498   896.252    142.9611                 NA        NA ## 2499   896.662     53.0129                 NA        NA ## 2500   898.602     91.5022                 NA        NA mtch <- mtch[whichQuery(mtch)] spectraData(mtch, c(\"rtime\", \"precursorMz\", \"target_precursorMz\", \"score\")) ## DataFrame with 78 rows and 4 columns ##         rtime precursorMz target_precursorMz     score ##     <numeric>   <numeric>          <numeric> <numeric> ## 1     173.184     305.156            305.157  0.926425 ## 2     173.184     305.156            305.157  0.926425 ## 3     173.184     305.156            305.157  0.926425 ## 4     173.184     305.156            305.157  0.926425 ## 5     173.184     305.156            305.157  0.926425 ## ...       ...         ...                ...       ... ## 74    527.419     279.156            279.159  0.814331 ## 75    527.419     279.156            279.159  0.822396 ## 76    570.096     373.039            373.041  0.934031 ## 77    570.506     373.042            373.041  0.888829 ## 78    570.825     373.040            373.041  0.827892 pandoc.table(style = \"rmarkdown\",     as.data.frame(spectraData(mtch, c(\"rtime\", \"target_compound_name\",                                       \"score\"))))"},{"path":"https://jorainer.github.io/SpectraTutorials/articles/Spectra-matching-with-MetaboAnnotation.html","id":"ms2-spectra-matching-in-an-xcms-workflow","dir":"Articles","previous_headings":"Overview","what":"MS2 spectra matching in an xcms workflow","title":"MS/MS Spectra Matching with the `MetaboAnnotation` Package","text":"LC-MS/MS-based untargeted metabolomics (small compound mass spectrometry experiments general) quantification compounds performed MS1 MS2 data used identification features. Quantification MS1 data requires chromatographic peak detection step can performed using functionality xcms package. load thus xcms package import full MS data using readMSData function. next perform chromatographic peak detection using centWave algorithm (see LC-MS/MS data analysis xcms vignette xcms package details chromatographic peak detection settings). total 99 chromatographic peaks identified. display first 6 . can now extract MS2 spectra chromatographic peak chromPeakSpectra function. function identifies MS2 spectra recorded instrument retention time within retention time precursor m/z within m/z boundaries chromatographic peak. setting return.type = \"Spectra\" ensure data returned newer Spectra format hence enabling simplified spectra matching functionality presented . Spectra variable peak_id contains identified chromatographic peak (.e. row name chromPeaks). next, like previous section, clean spectra removing peaks intensity 5% largest peak intensity per spectrum removing spectra single peak. addition scale also intensities within MS2 spectrum replacing intensities relative maximum peak intensity (see information). addition query spectra, also normalize MassBank spectra way. Next perform now spectra matching parameters previous section. , restrict MatchedSpectra query spectra matched. table lists compound names matching spectra chromatographic peaks. can also directly plot matching (query target) spectra using plotSpectraMirror function subsetting MatchedSpectra object query spectrum interest. plot third query spectrum matching target spectra.  Summarizing, chromPeakSpectra featureSpectra functions, xcms allows return MS data Spectra objects enables, shown simple example, perform MS2 spectra matching using Spectra well MetaboAnnotation packages hence simplifying MS/MS-based annotation LC-MS features xcms.","code":"library(xcms) pest_all <- readMSData(fl, mode = \"onDisk\") cwp <- CentWaveParam(snthresh = 5, noise = 100, ppm = 10,                      peakwidth = c(3, 30)) pest_all <- findChromPeaks(pest_all, param = cwp) head(chromPeaks(pest_all)) ##            mz    mzmin    mzmax      rt   rtmin   rtmax       into      intb ## CP01 142.9926 142.9921 142.9931 130.615 125.856 134.241  1113.8028  1106.229 ## CP02 221.0918 221.0906 221.0925 240.897 236.657 246.984   756.6935   744.779 ## CP03 220.0985 220.0978 220.0988 240.897 237.187 246.327  2060.5921  2052.549 ## CP04 219.0957 219.0950 219.0962 241.018 236.253 246.327 15172.6662 15133.811 ## CP05 153.0659 153.0655 153.0663 330.591 325.373 334.400  2148.7134  2141.943 ## CP06 235.1447 235.1441 235.1454 330.591 326.431 334.400  2836.2675  2829.627 ##           maxo  sn sample ## CP01  346.7006 102      1 ## CP02  212.5239  21      1 ## CP03  585.3036 151      1 ## CP04 4877.1162 367      1 ## CP05  784.9196 114      1 ## CP06 1006.9720 110      1 pest_ms2 <- chromPeakSpectra(pest_all, return.type = \"Spectra\") pest_ms2 ## MSn data (Spectra) with 158 spectra in a MsBackendMzR backend: ##            msLevel     rtime scanIndex ##          <integer> <numeric> <integer> ## F1.S1000         2   128.237      1000 ## F1.S1008         2   128.737      1008 ## F1.S1023         2   129.857      1023 ## F1.S1812         2   237.869      1812 ## F1.S1846         2   241.299      1846 ## ...            ...       ...       ... ## F1.S5115         2   575.255      5115 ## F1.S5272         2   596.584      5272 ## F1.S5236         2   592.424      5236 ## F1.S5266         2   596.054      5266 ## F1.S7344         2   873.714      7344 ##  ... 38 more variables/columns. ##  ## file(s): ## PestMix1_DDA.mzML pest_ms2$peak_id ##   [1] \"CP01\" \"CP01\" \"CP01\" \"CP04\" \"CP04\" \"CP05\" \"CP05\" \"CP06\" \"CP06\" \"CP08\" ##  [11] \"CP08\" \"CP11\" \"CP11\" \"CP12\" \"CP12\" \"CP13\" \"CP13\" \"CP13\" \"CP13\" \"CP14\" ##  [21] \"CP14\" \"CP14\" \"CP14\" \"CP18\" \"CP22\" \"CP22\" \"CP22\" \"CP22\" \"CP22\" \"CP25\" ##  [31] \"CP25\" \"CP25\" \"CP25\" \"CP25\" \"CP26\" \"CP26\" \"CP26\" \"CP26\" \"CP26\" \"CP26\" ##  [41] \"CP33\" \"CP33\" \"CP34\" \"CP34\" \"CP34\" \"CP34\" \"CP34\" \"CP35\" \"CP35\" \"CP35\" ##  [51] \"CP35\" \"CP35\" \"CP36\" \"CP41\" \"CP41\" \"CP41\" \"CP42\" \"CP42\" \"CP42\" \"CP42\" ##  [61] \"CP42\" \"CP44\" \"CP44\" \"CP46\" \"CP46\" \"CP46\" \"CP46\" \"CP47\" \"CP47\" \"CP47\" ##  [71] \"CP48\" \"CP48\" \"CP48\" \"CP50\" \"CP51\" \"CP51\" \"CP51\" \"CP52\" \"CP52\" \"CP52\" ##  [81] \"CP53\" \"CP53\" \"CP53\" \"CP53\" \"CP53\" \"CP57\" \"CP57\" \"CP57\" \"CP57\" \"CP57\" ##  [91] \"CP59\" \"CP59\" \"CP60\" \"CP60\" \"CP61\" \"CP61\" \"CP63\" \"CP63\" \"CP63\" \"CP63\" ## [101] \"CP64\" \"CP64\" \"CP64\" \"CP64\" \"CP64\" \"CP65\" \"CP66\" \"CP66\" \"CP66\" \"CP66\" ## [111] \"CP67\" \"CP67\" \"CP67\" \"CP69\" \"CP69\" \"CP69\" \"CP71\" \"CP71\" \"CP71\" \"CP71\" ## [121] \"CP72\" \"CP72\" \"CP72\" \"CP73\" \"CP81\" \"CP81\" \"CP81\" \"CP81\" \"CP82\" \"CP82\" ## [131] \"CP82\" \"CP85\" \"CP85\" \"CP88\" \"CP88\" \"CP89\" \"CP89\" \"CP89\" \"CP90\" \"CP90\" ## [141] \"CP90\" \"CP91\" \"CP91\" \"CP91\" \"CP93\" \"CP93\" \"CP93\" \"CP93\" \"CP93\" \"CP93\" ## [151] \"CP94\" \"CP94\" \"CP94\" \"CP94\" \"CP95\" \"CP98\" \"CP98\" \"CP99\" #' Remove peaks with an intensity below 5% pest_ms2 <- filterIntensity(pest_ms2, intensity = low_int)  #' Remove peaks with a single peak pest_ms2 <- pest_ms2[lengths(pest_ms2) > 1] #' Define a function to *normalize* the intensities norm_int <- function(x, ...) {     maxint <- max(x[, \"intensity\"], na.rm = TRUE)     x[, \"intensity\"] <- 100 * x[, \"intensity\"] / maxint     x } #' *Apply* the function to the data pest_ms2 <- addProcessing(pest_ms2, norm_int) mbank <- addProcessing(mbank, norm_int) pest_match <- matchSpectra(pest_ms2, mbank, param = prm) pest_match ## Object of class MatchedSpectra  ## Total number of matches: 31  ## Number of query objects: 155 (7 matched) ## Number of target objects: 86576 (19 matched) pest_match <- pest_match[whichQuery(pest_match)] pandoc.table(     style = \"rmarkdown\",     as.data.frame(spectraData(pest_match, c(\"peak_id\", \"rtime\",                                             \"target_compound_name\")))) plotSpectraMirror(pest_match[3])"},{"path":"https://jorainer.github.io/SpectraTutorials/articles/Spectra-matching-with-MetaboAnnotation.html","id":"session-information","dir":"Articles","previous_headings":"","what":"Session information","title":"MS/MS Spectra Matching with the `MetaboAnnotation` Package","text":"","code":"sessionInfo() ## R version 4.3.0 (2023-04-21) ## Platform: x86_64-pc-linux-gnu (64-bit) ## Running under: Ubuntu 22.04.2 LTS ##  ## Matrix products: default ## BLAS:   /usr/lib/x86_64-linux-gnu/openblas-pthread/libblas.so.3  ## LAPACK: /usr/lib/x86_64-linux-gnu/openblas-pthread/libopenblasp-r0.3.20.so;  LAPACK version 3.10.0 ##  ## locale: ##  [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C               ##  [3] LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8     ##  [5] LC_MONETARY=en_US.UTF-8    LC_MESSAGES=en_US.UTF-8    ##  [7] LC_PAPER=en_US.UTF-8       LC_NAME=C                  ##  [9] LC_ADDRESS=C               LC_TELEPHONE=C             ## [11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C        ##  ## time zone: Etc/UTC ## tzcode source: system (glibc) ##  ## attached base packages: ## [1] stats4    stats     graphics  grDevices utils     datasets  methods   ## [8] base      ##  ## other attached packages: ##  [1] xcms_3.22.0             MSnbase_2.26.0          mzR_2.34.0              ##  [4] Rcpp_1.0.10             Biobase_2.60.0          MetaboAnnotation_1.5.1  ##  [7] MsBackendMassbank_1.7.4 RMariaDB_1.2.2          pander_0.6.5            ## [10] Spectra_1.11.2          ProtGenerics_1.32.0     BiocParallel_1.34.2     ## [13] S4Vectors_0.38.1        BiocGenerics_0.46.0     BiocStyle_2.28.0        ##  ## loaded via a namespace (and not attached): ##   [1] RColorBrewer_1.1-3          jsonlite_1.8.4              ##   [3] MultiAssayExperiment_1.26.0 magrittr_2.0.3              ##   [5] MALDIquant_1.22.1           rmarkdown_2.21              ##   [7] fs_1.6.2                    zlibbioc_1.46.0             ##   [9] ragg_1.2.5                  vctrs_0.6.2                 ##  [11] multtest_2.56.0             memoise_2.0.1               ##  [13] RCurl_1.98-1.12             base64enc_0.1-3             ##  [15] htmltools_0.5.5             S4Arrays_1.0.4              ##  [17] mzID_1.38.0                 sass_0.4.6                  ##  [19] bslib_0.4.2                 htmlwidgets_1.6.2           ##  [21] desc_1.4.2                  plyr_1.8.8                  ##  [23] impute_1.74.1               lubridate_1.9.2             ##  [25] cachem_1.0.8                igraph_1.4.3                ##  [27] lifecycle_1.0.3             iterators_1.0.14            ##  [29] pkgconfig_2.0.3             Matrix_1.5-4.1              ##  [31] R6_2.5.1                    fastmap_1.1.1               ##  [33] GenomeInfoDbData_1.2.10     MatrixGenerics_1.12.0       ##  [35] clue_0.3-64                 digest_0.6.31               ##  [37] pcaMethods_1.92.0           rsvg_2.4.0                  ##  [39] colorspace_2.1-0            rprojroot_2.0.3             ##  [41] textshaping_0.3.6           GenomicRanges_1.52.0        ##  [43] RSQLite_2.3.1               fansi_1.0.4                 ##  [45] timechange_0.2.0            compiler_4.3.0              ##  [47] bit64_4.0.5                 doParallel_1.0.17           ##  [49] DBI_1.1.3                   highr_0.10                  ##  [51] MASS_7.3-60                 ChemmineR_3.52.0            ##  [53] DelayedArray_0.26.3         rjson_0.2.21                ##  [55] tools_4.3.0                 CompoundDb_1.3.3            ##  [57] glue_1.6.2                  QFeatures_1.10.0            ##  [59] grid_4.3.0                  cluster_2.1.4               ##  [61] generics_0.1.3              gtable_0.3.3                ##  [63] preprocessCore_1.62.1       hms_1.1.3                   ##  [65] MetaboCoreUtils_1.8.0       xml2_1.3.4                  ##  [67] utf8_1.2.3                  XVector_0.40.0              ##  [69] RANN_2.6.1                  foreach_1.5.2               ##  [71] pillar_1.9.0                stringr_1.5.0               ##  [73] limma_3.56.1                splines_4.3.0               ##  [75] robustbase_0.95-1           dplyr_1.1.2                 ##  [77] lattice_0.21-8              survival_3.5-5              ##  [79] bit_4.0.5                   tidyselect_1.2.0            ##  [81] knitr_1.43                  gridExtra_2.3               ##  [83] IRanges_2.34.0              SummarizedExperiment_1.30.1 ##  [85] xfun_0.39                   matrixStats_0.63.0          ##  [87] DEoptimR_1.0-13             DT_0.28                     ##  [89] stringi_1.7.12              lazyeval_0.2.2              ##  [91] yaml_2.3.7                  evaluate_0.21               ##  [93] codetools_0.2-19            MsCoreUtils_1.12.0          ##  [95] tibble_3.2.1                BiocManager_1.30.20         ##  [97] cli_3.6.1                   affyio_1.70.0               ##  [99] systemfonts_1.0.4           munsell_0.5.0               ## [101] jquerylib_0.1.4             MassSpecWavelet_1.66.0      ## [103] GenomeInfoDb_1.36.0         dbplyr_2.3.2                ## [105] png_0.1-8                   XML_3.99-0.14               ## [107] parallel_4.3.0              pkgdown_2.0.7               ## [109] ggplot2_3.4.2               blob_1.2.4                  ## [111] AnnotationFilter_1.24.0     bitops_1.0-7                ## [113] MsFeatures_1.8.0            scales_1.2.1                ## [115] affy_1.78.0                 ncdf4_1.21                  ## [117] purrr_1.0.1                 crayon_1.5.2                ## [119] rlang_1.1.1                 vsn_3.68.0"},{"path":[]},{"path":[]},{"path":"https://jorainer.github.io/SpectraTutorials/articles/analyzing-MS-data-from-different-sources-with-Spectra.html","id":"description","dir":"Articles","previous_headings":"Overview","what":"Description","title":"Seamless Integration of Mass Spectrometry Data from Different Sources with the `Spectra` Package","text":"Mass spectrometry (MS) data key technology modern proteomics metabolomics experiments. Due continuous improvements MS instrumentation, generated data can easily become large. Also, additional resources MS data exist, spectra libraries databases, specific file formats database systems sometimes support manipulations original data. Learning experiences MSnbase Bioconductor package, Spectra package developed provide even flexible expandable infrastructure MS data R. package implements clear separation user interface code provide, store import MS data. latter defined MsBackend interface allows implementation data type, format storage-dependent backends. Backends can thus implemented specific file types data resources different ways represent MS data (e.g. memory -disk data representations described (Gatto, Gibb, Rainer 2020)). also supposed interchangeable hence allowing user switch backends without affecting analysis. enable processing also large MS data sets, data manipulations default directly applied data cached lazy evaluation queue allows analyses also read-data representations. workshop shows expandability new infrastructure enable seamless integration analysis MS data variety input formats. illustrated simple comparison matching experimental MS2 spectra public spectral databases export data format commonly used exchange MS2 data.","code":""},{"path":"https://jorainer.github.io/SpectraTutorials/articles/analyzing-MS-data-from-different-sources-with-Spectra.html","id":"pre-requisites","dir":"Articles","previous_headings":"Overview","what":"Pre-requisites","title":"Seamless Integration of Mass Spectrometry Data from Different Sources with the `Spectra` Package","text":"Basic familiarity R Bioconductor. Basic understanding Mass Spectrometry (MS) data.","code":""},{"path":"https://jorainer.github.io/SpectraTutorials/articles/analyzing-MS-data-from-different-sources-with-Spectra.html","id":"installation-and-participation","dir":"Articles","previous_headings":"Overview","what":"Installation and Participation","title":"Seamless Integration of Mass Spectrometry Data from Different Sources with the `Spectra` Package","text":"Get docker image tutorial docker pull jorainer/spectra_tutorials:latest. Start docker using Enter http://localhost:8787 web browser log username rstudio password bioc. Open R-markdown file (vignettes/analyzing-MS-data--different-sources--Spectra.Rmd) RStudio server version web browser evaluate R code blocks. get source code: clone github repository, e.g. git clone https://github.com/jorainer/SpectraTutorials. alternative way install packages data workshop see README file workshop’s github repository.","code":"docker run \\     -e PASSWORD=bioc \\     -p 8787:8787 \\     jorainer/spectra_tutorials:latest"},{"path":"https://jorainer.github.io/SpectraTutorials/articles/analyzing-MS-data-from-different-sources-with-Spectra.html","id":"rbioconductor-packages-used","dir":"Articles","previous_headings":"Overview","what":"R/Bioconductor packages used","title":"Seamless Integration of Mass Spectrometry Data from Different Sources with the `Spectra` Package","text":"Spectra MsCoreUtils MsBackendMgf MsBackendMassbank CompoundDb","code":""},{"path":[]},{"path":[]},{"path":[]},{"path":"https://jorainer.github.io/SpectraTutorials/articles/analyzing-MS-data-from-different-sources-with-Spectra.html","id":"learning-goals","dir":"Articles","previous_headings":"Overview > Workshop goals and objectives","what":"Learning goals","title":"Seamless Integration of Mass Spectrometry Data from Different Sources with the `Spectra` Package","text":"Understand import MS data R. Understand basic concept backends Spectra can used work MS data various sources.","code":""},{"path":"https://jorainer.github.io/SpectraTutorials/articles/analyzing-MS-data-from-different-sources-with-Spectra.html","id":"learning-objectives","dir":"Articles","previous_headings":"Overview > Workshop goals and objectives","what":"Learning objectives","title":"Seamless Integration of Mass Spectrometry Data from Different Sources with the `Spectra` Package","text":"Import export MS data Spectra. Integrate MS data different resources MS data analysis workflow. Apply different data manipulations MS data represented Spectra object. Use Spectra perform spectra comparisons R.","code":""},{"path":[]},{"path":"https://jorainer.github.io/SpectraTutorials/articles/analyzing-MS-data-from-different-sources-with-Spectra.html","id":"lc-msms-in-a-nutshell","dir":"Articles","previous_headings":"Workshop","what":"LC-MS/MS in a nutshell","title":"Seamless Integration of Mass Spectrometry Data from Different Sources with the `Spectra` Package","text":"Mass spectrometry (MS) instruments measure mass--charge ratios (m/z) abundances ions. resulting m/z intensity values stored/represented spectrum. compounds charged, need ionized first (e.g. electro spray ionization (ESI)). MS usually combined another separation technique, liquid chromatography (LC). adds another dimension data: retention time (rt). LC-MS data represented multiple spectra, spectrum retention time. LC-MS setup LC-MS measure features characterized m/z retention time - still don’t know molecule actually measured. Create addition fragment (MS/MS) spectra ions get information structure. CID-based fragmentation Commonly used method: collision induced dissociation (CID). collision chamber filled e.g. N2, ions get fragmented spectrum fragments recorded (Steckel Schlosser 2019). Comparing matching fragment spectra reference helps identifying compound.","code":""},{"path":"https://jorainer.github.io/SpectraTutorials/articles/analyzing-MS-data-from-different-sources-with-Spectra.html","id":"the-spectra-package","dir":"Articles","previous_headings":"Workshop","what":"The Spectra package","title":"Seamless Integration of Mass Spectrometry Data from Different Sources with the `Spectra` Package","text":"Purpose: provide expandable, well tested user-friendly infrastructure mass spectrometry (MS) data. Design: separation user interface (functions) code provide, store read MS data. Advantage: support different ways store handle data without affecting user functionality: functionality Spectra object independent data , either -memory, -disk, locally remote. Expandable: implementation additional backend classes (extending MsBackend virtual class) possible add support additional input file formats data representations without needing change Spectra package object. Spectra: separation user functionality data representation workshop : import MS data mzML files, select MS2 spectra certain compound, compare match MS2 spectra reference MS2 spectra public database, annotate spectra export file MGF format.","code":""},{"path":"https://jorainer.github.io/SpectraTutorials/articles/analyzing-MS-data-from-different-sources-with-Spectra.html","id":"ms-data-import-and-handling","dir":"Articles","previous_headings":"Workshop","what":"MS data import and handling","title":"Seamless Integration of Mass Spectrometry Data from Different Sources with the `Spectra` Package","text":"import MS data mzML files provided within package. files contain MSn data mix 8 standard compounds (added either water pool human serum samples) measured HILIC-based LC-MS/MS setup. MS2 data generated data dependent acquisition using collision energy 20eV. data import representation experimental data use MsBackendMzR backend supports import (export) data common raw mass spectrometry file formats (.e. mzML, mzXML CDF). MS data now represented Spectra object, can thought data.frame rows individual spectra columns spectra variables (\"rtime\", .e. retention time). spectraVariables function lists available variables within Spectra object. spectra variable can accessed either via $ name using dedicated access function (preferred way). extract retention times first spectra using either $rtime function rtime. Spectra object contains information total 1578 spectra length(unique(dataOrigin(sps_all))) mzML files. using MsBackendMzR backend, general information spectrum kept memory resulting low memory footprint. spectra’s m/z intensity values can accessed mz intensity functions also peaksData function returns list numeric matrices m/z intensity values. using MsBackendMzR backend, retrieved demand original data files time functions called. can also load full data memory changing backend MsBackendMzR MsBackendDataFrame. affect way use Spectra object : operations functions available, independently way data stored (.e. backend used). size Spectra object now larger, since full data loaded memory. subset Spectra objects, can use either [ one many available filter* functions (usually efficient [). subset sps_all arbitrary spectra simply using: workshop, next want identify experimental data MS2 spectra generated ion matches m/z [M+H]+ ion metabolite cystine (one standards added sample mix measured present experimental data). thus use filterPrecursorMzValues function subset data MS2 spectra matching m/z (accepting difference m/z 10 parts-per-million (ppm)). total 6 spectra matched target precursor m/z.","code":"library(Spectra)  #' Define the input files fls <- dir(system.file(\"mzML\", package = \"SpectraTutorials\"),            full.names = TRUE)  #' Import the data sps_all <- Spectra(fls, source = MsBackendMzR()) #' List all available spectra variables (attributes) spectraVariables(sps_all) ##  [1] \"msLevel\"                  \"rtime\"                    ##  [3] \"acquisitionNum\"           \"scanIndex\"                ##  [5] \"dataStorage\"              \"dataOrigin\"               ##  [7] \"centroided\"               \"smoothed\"                 ##  [9] \"polarity\"                 \"precScanNum\"              ## [11] \"precursorMz\"              \"precursorIntensity\"       ## [13] \"precursorCharge\"          \"collisionEnergy\"          ## [15] \"isolationWindowLowerMz\"   \"isolationWindowTargetMz\"  ## [17] \"isolationWindowUpperMz\"   \"peaksCount\"               ## [19] \"totIonCurrent\"            \"basePeakMZ\"               ## [21] \"basePeakIntensity\"        \"ionisationEnergy\"         ## [23] \"lowMZ\"                    \"highMZ\"                   ## [25] \"mergedScan\"               \"mergedResultScanNum\"      ## [27] \"mergedResultStartScanNum\" \"mergedResultEndScanNum\"   ## [29] \"injectionTime\"            \"filterString\"             ## [31] \"spectrumId\"               \"ionMobilityDriftTime\"     ## [33] \"scanWindowLowerLimit\"     \"scanWindowUpperLimit\" #' Access the spectras' retention time sps_all$rtime |> head() ## [1] 0.273 0.570 0.873 1.183 1.491 1.798 rtime(sps_all) |> head() ## [1] 0.273 0.570 0.873 1.183 1.491 1.798 print(object.size(sps_all), units = \"MB\") ## 0.4 Mb ## Show the first 6 lines of the first spectrum's peak matrix peaksData(sps_all)[[1L]] |> head() ##            mz intensity ## [1,] 50.22647  383.7802 ## [2,] 52.97586  377.5944 ## [3,] 59.97846  518.6014 ## [4,] 60.04677 4716.1259 ## [5,] 60.06897  181.5105 ## [6,] 61.02565  250.6573 #' Change backend to a MsBackendDataFrame: load data into memory sps_all <- setBackend(sps_all, MsBackendDataFrame()) print(object.size(sps_all), units = \"MB\") ## 16.5 Mb sps_all[c(4, 2, 5)] ## MSn data (Spectra) with 3 spectra in a MsBackendDataFrame backend: ##     msLevel     rtime scanIndex ##   <integer> <numeric> <integer> ## 1         1     1.183         4 ## 2         1     0.570         2 ## 3         1     1.491         5 ##  ... 33 more variables/columns. ## Processing: ##  Switch backend from MsBackendMzR to MsBackendDataFrame [Thu May 25 12:04:37 2023] #' Define the m/z ratio for an ion of cystine mz <- 241.0311  #' Subset the dataset to MS2 spectra matching the m/z sps <- filterPrecursorMzValues(sps_all, mz = mz, ppm = 10) sps ## MSn data (Spectra) with 6 spectra in a MsBackendDataFrame backend: ##     msLevel     rtime scanIndex ##   <integer> <numeric> <integer> ## 1         2   209.936       673 ## 2         2   220.072       714 ## 3         2   231.604       734 ## 4         2   215.089       761 ## 5         2   225.739       781 ## 6         2   240.020       804 ##  ... 33 more variables/columns. ## Processing: ##  Switch backend from MsBackendMzR to MsBackendDataFrame [Thu May 25 12:04:37 2023] ##  Filter: select spectra with precursor m/z matching 241.0311 [Thu May 25 12:04:38 2023]"},{"path":"https://jorainer.github.io/SpectraTutorials/articles/analyzing-MS-data-from-different-sources-with-Spectra.html","id":"data-processing-and-manipulation","dir":"Articles","previous_headings":"Workshop","what":"Data processing and manipulation","title":"Seamless Integration of Mass Spectrometry Data from Different Sources with the `Spectra` Package","text":"plotSpectra function can used visualize spectra. plot first spectrum data subset.  raw MS2 spectrum contains many low intensity peaks, likely representing noise. Thus next filter spectra removing peaks intensity smaller 5% maximum intensity spectrum (.e. base peak intensity). end define function takes intensity values spectrum input returns logical value whether peak retained (TRUE) (FALSE). function passed filterIntensity function perform actual filtering spectra. filtering, spectra cleaner:  addition want replace absolute peak intensities values relative spectrum’s highest peak intensity. end define function takes peak matrix input (.e. numeric matrix columns containing m/z intensity values) returns two-column numeric matrix. function passed parameter FUN addProcessing function perform desired data processing. addProcessing function allows add user-defined data manipulation operation MS data (.e. peaks matrices) Spectra object. show effect data processing extract intensities first spectrum: intensity values now 0 100.","code":"#' Plot the first spectrum plotSpectra(sps[1]) #' Define a filtering function low_int <- function(x, ...) {     x > max(x, na.rm = TRUE) * 0.05 } #' Apply the function to filter the spectra sps <- filterIntensity(sps, intensity = low_int) #' Plot the first spectrum after filtering plotSpectra(sps[1]) #' Define a function to scale the intensities. `x` is expected to be a #' *peak matrix*, i.e. numeric matrix with columns m/z and intensity scale_int <- function(x, ...) {     maxint <- max(x[, \"intensity\"], na.rm = TRUE)     x[, \"intensity\"] <- 100 * x[, \"intensity\"] / maxint     x } #' *Apply* the function to the data sps <- addProcessing(sps, scale_int) #' Get the intensities after scaling peaksData(sps)[[1L]] ##             mz  intensity ## [1,]  74.02289  13.439402 ## [2,] 120.01111  93.631648 ## [3,] 122.02667  49.287979 ## [4,] 151.98277 100.000000 ## [5,] 153.99924   9.422415 ## [6,] 177.99880   6.581111 ## [7,] 195.02556  12.969807 ## [8,] 241.03074  54.633224"},{"path":"https://jorainer.github.io/SpectraTutorials/articles/analyzing-MS-data-from-different-sources-with-Spectra.html","id":"spectrum-data-comparison","dir":"Articles","previous_headings":"Workshop","what":"Spectrum data comparison","title":"Seamless Integration of Mass Spectrometry Data from Different Sources with the `Spectra` Package","text":"next perform pairwise comparison subsetted spectra using dot product similarity measure. Prior actual similarity calculation, peaks individual spectra matched (.e. determined peak one spectrum correspond spectrum based mass--charge ratios). specify ppm = 20 peaks difference m/z smaller 20ppm considered matching. pairwise spectra similarities represented heatmap (note RStudio docker might crash pheatmap call - avoid add filename = \"hm.pdf\" heatmap call).  similarity selected experimental MS2 spectra high (fact 0.88) suggesting fragment spectra original compound.","code":"#' Pairwise comparison of all spectra sim_mat <- compareSpectra(sps, ppm = 20) sim_mat ##           [,1]      [,2]      [,3]      [,4]      [,5]      [,6] ## [1,] 1.0000000 0.9717669 0.8907129 0.9721095 0.8795912 0.8818719 ## [2,] 0.9717669 1.0000000 0.9992127 0.9964783 0.9525726 0.9486682 ## [3,] 0.8907129 0.9992127 1.0000000 0.9947650 0.9518138 0.9478201 ## [4,] 0.9721095 0.9964783 0.9947650 1.0000000 0.9543584 0.9494561 ## [5,] 0.8795912 0.9525726 0.9518138 0.9543584 1.0000000 0.9994800 ## [6,] 0.8818719 0.9486682 0.9478201 0.9494561 0.9994800 1.0000000 library(pheatmap) hm <- pheatmap(sim_mat, breaks = seq(0, 1, length.out = 101))"},{"path":"https://jorainer.github.io/SpectraTutorials/articles/analyzing-MS-data-from-different-sources-with-Spectra.html","id":"comparing-spectra-against-massbank","dir":"Articles","previous_headings":"Workshop","what":"Comparing spectra against MassBank","title":"Seamless Integration of Mass Spectrometry Data from Different Sources with the `Spectra` Package","text":"Although precursor m/z spectra matches m/z cystine, can still exclude represent fragments ions different compounds (m/z cystine). Matching experimental spectra public spectral library can used first step identification process untargeted metabolomics data. Several (public) spectral libraries small molecules available, : MassBank MassBank North America MoNa Human Metabolom Database HMDB GNPS … databases MsBackend interfaces already implemented allowing inclusion data directly R-based analysis workflows. Access MassBank data example possible MsBackendMassbank package. package provides MsBackendMassbank import/export MassBank files well MsBackendMassbankSql backend directly interfaces MassBank MySQL database. connect local installation MassBank MySQL database (release 2021.03 provided within docker image tutorial). Alternatively, MySQL database system available tutorial can run within docker, SQLite database version MassBank data (format required MsBackendMassbankSql available . downloading database MassbankSql-2021-03.db current R workspace, resource can loaded code . next load MsBackendMassbank package initialize Spectra object MsBackendMassbankSql backend providing database connection (either MySQL SQLite connection generated ). Spectra object mbank represents now MS data MassBank database total length(mbank) spectra. fact, mbank object contain MS data, primary keys spectra MassBank database. Hence, also relatively low memory footprint. operation Spectra object backend load requested data database demand. Calling intensity Spectra object example retrieve intensity values spectra database. extract peaks matrix first spectrum. can see, also MassBank provides absolute intensities spectrum. data scale, however like scale values 0 100, just like experimental data. thus apply data processing operation also MassBank Spectra object. worked, although (obvious reasons) allowed change m/z intensity values within MassBank database. possible? works, data manipulation operation Spectra object cached within object’s lazy evaluation queue operation applied m/z intensity values --fly whenever data requested (.e. whenever mz intensity called ). side effect, also allows undo certain data operations simply calling reset Spectra object. next want compare experimental spectra spectra MassBank. Instead comparing 86576 available spectra, first filter MassBank database spectra precursor m/z matching one [M+H]+ ion cystine. Note , alternative filterPrecursorMzValues used , also use containsMz function screen spectra containing actual peak matching precursor m/z. left us 12 spectra calculate similarity experimental spectra using compareSpectra function. result got (normalized dot product) similarity score tested MassBank spectrum (rows) experimental spectrum (columns).  get high similarity scores, also lower ones. next determine best matching pair comparisons. best_match variable contains now index best matching MassBank experimental spectrum. visualize two using mirror plot showing upper panel MS2 spectrum MassBank lower panel best matching experimental spectrum. Matching peaks highlighted blue color. Plotting functions Spectra highly customizable example add m/z individual peak annotation intensity peak higher 5.  comparison plot also two spectra low similarity score.  Since identify MassBank spectrum high similarity experimental spectra also like know compound spectrum actually represents. Spectra objects generally flexible can arbitrarily many additional annotation fields (.e. spectra variables) spectrum. Thus, use spectraVariables function list variables available MassBank Spectra object. fact, addition spectra specific information like instrument measured ionization voltage used, get also information originating compound name (\"compound_name\"), chemical formula (\"formula\") INChI key (\"inchikey\"). thus next subset mbank_sub best matching spectrum display associated compound name. Indeed, experimental cystine spectrum matches (one) cystine spectrum MassBank. next add name chemical formula spectrum experimental spectra. also set collision energy 20eV assign ion/adduct cystine reference spectrum created. Spectra allows adding new (replacing existing) spectra variables using $<-. Note: convenient spectra matching functionality designed less experienced R users available MetaboAnnotation package. second tutorial available within github repository/R package additional tutorials can found MetaboAnnotationTutorials repository/R package.","code":"library(RMariaDB) #' Connect to the MassBank MySQL database con <- dbConnect(MariaDB(), user = \"massbank\", dbname = \"MassBank\",                  host = \"localhost\", pass = \"massbank\") ## Alternative to the MySQL server - assuming the SQLite database was ## stored to the R working directory. library(RSQLite) con <- dbConnect(SQLite(), \"MassbankSql-2021-03.db\") library(MsBackendMassbank) #' Access the spectra data in MassBank mbank <- Spectra(con, source = MsBackendMassbankSql()) mbank ## MSn data (Spectra) with 86576 spectra in a MsBackendMassbankSql backend: ##         msLevel precursorMz  polarity ##       <integer>   <numeric> <integer> ## 1             2         506         0 ## 2            NA          NA         1 ## 3            NA          NA         0 ## 4            NA          NA         1 ## 5            NA          NA         0 ## ...         ...         ...       ... ## 86572         2     449.380         1 ## 86573         2     426.022         0 ## 86574         2     131.060         0 ## 86575         2     183.170         1 ## 86576         2     358.270         0 ##  ... 42 more variables/columns. ##  Use  'spectraVariables' to list all of them. print(object.size(mbank), units = \"MB\") ## 6.6 Mb #' Get peaks matrix for the first spectrum peaksData(mbank[1])[[1L]] ##             mz    intensity ##  [1,] 146.7608     0.980184 ##  [2,] 158.8635   938.145447 ##  [3,] 174.9888    56.718353 ##  [4,] 176.8688   847.169678 ##  [5,] 213.9867   133.479233 ##  [6,] 221.0402     3.189743 ##  [7,] 238.9681    76.114944 ##  [8,] 246.3159     2.592528 ##  [9,] 255.0206     2.059480 ## [10,] 256.8184     1.597428 ## [11,] 272.9973   801.059082 ## [12,] 290.9484     4.848598 ## [13,] 293.9753     1.233919 ## [14,] 310.1210    33.710808 ## [15,] 352.9528    49.103123 ## [16,] 370.9348   461.860779 ## [17,] 390.0576     4.611422 ## [18,] 408.0003 23963.912109 ## [19,] 409.0284     0.884388 ## [20,] 426.1263    69.098648 ## [21,] 470.0574     2.051622 ## [22,] 487.9893   812.386597 ## [23,] 585.8845     1.093564 #' Scale intensities for all MassBank spectra mbank <- addProcessing(mbank, scale_int) peaksData(mbank[1])[[1L]] ##             mz    intensity ##  [1,] 146.7608 4.090250e-03 ##  [2,] 158.8635 3.914826e+00 ##  [3,] 174.9888 2.366824e-01 ##  [4,] 176.8688 3.535189e+00 ##  [5,] 213.9867 5.570010e-01 ##  [6,] 221.0402 1.331061e-02 ##  [7,] 238.9681 3.176232e-01 ##  [8,] 246.3159 1.081847e-02 ##  [9,] 255.0206 8.594089e-03 ## [10,] 256.8184 6.665973e-03 ## [11,] 272.9973 3.342773e+00 ## [12,] 290.9484 2.023292e-02 ## [13,] 293.9753 5.149072e-03 ## [14,] 310.1210 1.406732e-01 ## [15,] 352.9528 2.049045e-01 ## [16,] 370.9348 1.927318e+00 ## [17,] 390.0576 1.924319e-02 ## [18,] 408.0003 1.000000e+02 ## [19,] 409.0284 3.690499e-03 ## [20,] 426.1263 2.883446e-01 ## [21,] 470.0574 8.561298e-03 ## [22,] 487.9893 3.390042e+00 ## [23,] 585.8845 4.563378e-03 #' Filter MassBank for spectra of precursor ion mbank_sub <- filterPrecursorMzValues(mbank, mz = mz, ppm = 10) mbank_sub ## MSn data (Spectra) with 12 spectra in a MsBackendMassbankSql backend: ##       msLevel precursorMz  polarity ##     <integer>   <numeric> <integer> ## 1           2     241.031         1 ## 2           2     241.031         1 ## 3           2     241.031         1 ## 4           2     241.031         1 ## 5           2     241.031         1 ## ...       ...         ...       ... ## 8           2     241.031         1 ## 9           2     241.031         1 ## 10          2     241.031         1 ## 11          2     241.031         1 ## 12          2     241.031         1 ##  ... 42 more variables/columns. ##  Use  'spectraVariables' to list all of them. ## Lazy evaluation queue: 1 processing step(s) ## Processing: ##  Filter: select spectra with precursor m/z matching 241.0311 [Thu May 25 12:04:42 2023] #' Compare MassBank subset to experimental spectra res <- compareSpectra(sps, mbank_sub, ppm = 20) res ##       RP014401  RP014402    RP014403  CE000600  CE000598  CE000602  CE000595 ## [1,] 0.2026317 0.3343503 0.024658599 0.9021127 0.9069832 0.7714246 0.4711052 ## [2,] 0.1807144 0.2933160 0.021440961 0.8863867 0.8655798 0.7507946 0.4307388 ## [3,] 0.1801990 0.2892779 0.005165072 0.8862688 0.8541779 0.7335706 0.4406949 ## [4,] 0.1596113 0.3067826 0.005668103 0.8666230 0.8760503 0.7770975 0.4382448 ## [5,] 0.1784321 0.3608116 0.005392068 0.8792278 0.9101864 0.7761744 0.5016645 ## [6,] 0.1871595 0.3629835 0.005564441 0.8849054 0.8705634 0.7200598 0.5052482 ##       CE000599  CE000596  CE000597  CE000603  CE000601 ## [1,] 0.5101048 0.7358534 0.2843629 0.6267950 0.6085564 ## [2,] 0.5304578 0.7415840 0.3069911 0.6079285 0.5669921 ## [3,] 0.5379880 0.7480320 0.3157130 0.6220260 0.5458613 ## [4,] 0.4738241 0.6957804 0.2580864 0.5819616 0.6049588 ## [5,] 0.4913249 0.7185230 0.2783447 0.6469762 0.6055037 ## [6,] 0.5013606 0.7278495 0.2864854 0.6554185 0.5523657 pheatmap(res) best_match <- which(res == max(res), arr.ind = TRUE) best_match ##      row col ## [1,]   5   5 #' Specifying a function to draw peak labels label_fun <- function(x) {     ints <- unlist(intensity(x))     mzs <- format(unlist(mz(x)), digits = 4)     mzs[ints < 5] <- \"\"     mzs } plotSpectraMirror(mbank_sub[best_match[1]], sps[best_match[2]],                   ppm = 20, labels = label_fun, labelPos = 2,                   labelOffset = 0.2, labelSrt = -30) grid() plotSpectraMirror(mbank_sub[1], sps[3],                   ppm = 20, labels = label_fun, labelPos = 2,                   labelOffset = 0.2, labelSrt = -30) grid() #' What variables are available in MassBank spectraVariables(mbank_sub) ##  [1] \"msLevel\"                 \"rtime\"                   ##  [3] \"acquisitionNum\"          \"scanIndex\"               ##  [5] \"dataStorage\"             \"dataOrigin\"              ##  [7] \"centroided\"              \"smoothed\"                ##  [9] \"polarity\"                \"precScanNum\"             ## [11] \"precursorMz\"             \"precursorIntensity\"      ## [13] \"precursorCharge\"         \"collisionEnergy\"         ## [15] \"isolationWindowLowerMz\"  \"isolationWindowTargetMz\" ## [17] \"isolationWindowUpperMz\"  \"spectrum_id\"             ## [19] \"spectrum_name\"           \"date\"                    ## [21] \"authors\"                 \"license\"                 ## [23] \"copyright\"               \"publication\"             ## [25] \"splash\"                  \"compound_id\"             ## [27] \"adduct\"                  \"ionization\"              ## [29] \"ionization_voltage\"      \"fragmentation_mode\"      ## [31] \"collision_energy_text\"   \"instrument\"              ## [33] \"instrument_type\"         \"formula\"                 ## [35] \"exactmass\"               \"smiles\"                  ## [37] \"inchi\"                   \"inchikey\"                ## [39] \"cas\"                     \"pubchem\"                 ## [41] \"synonym\"                 \"precursor_mz_text\"       ## [43] \"compound_name\" mbank_best_match <- mbank_sub[best_match[1]] mbank_best_match$compound_name ## [1] \"Cystine\" #' Add annotations to the experimental spectra sps$name <- mbank_best_match$compound_name sps$formula <- mbank_best_match$formula sps$adduct <- mbank_best_match$adduct sps$collisionEnergy <- 20"},{"path":"https://jorainer.github.io/SpectraTutorials/articles/analyzing-MS-data-from-different-sources-with-Spectra.html","id":"data-export","dir":"Articles","previous_headings":"Workshop","what":"Data export","title":"Seamless Integration of Mass Spectrometry Data from Different Sources with the `Spectra` Package","text":"last want export spectra file MGF format. use MsBackendMgf package provides MsBackendMgf backend adds support MGF file import/export Spectra objects. Data Spectra objects can generally exported export function. format data exported depends specified MsBackend class. using instance MsBackendMgf define export data file MGF format. read first 6 lines resulting file.","code":"library(MsBackendMgf)  #' Export the spectra to a MGF file export(sps, backend = MsBackendMgf(), file = \"Cystine_ce20.mgf\") readLines(\"Cystine_ce20.mgf\", n = 6) ## [1] \"BEGIN IONS\"                                ## [2] \"TITLE=msLevel 2; retentionTime ; scanNum \" ## [3] \"msLevel=2\"                                 ## [4] \"RTINSECONDS=209.93599999998\"               ## [5] \"SCANS=673\"                                 ## [6] \"scanIndex=673\""},{"path":"https://jorainer.github.io/SpectraTutorials/articles/analyzing-MS-data-from-different-sources-with-Spectra.html","id":"comparing-spectra-against-hmdb","dir":"Articles","previous_headings":"Workshop","what":"Comparing spectra against HMDB","title":"Seamless Integration of Mass Spectrometry Data from Different Sources with the `Spectra` Package","text":"addition MsBackendMassbank, provides access MassBank data, also MsBackendHmdb package supporting spectral data public Human Metabolome Database (HMDB). package however yet provide direct access HMDB database , MsBackendHmdbXml backend, allows import MS2 spectra files HMDB format. provided HMDB individual xml files custom file format bundled (can hence downloaded) single archive. alternative, also possible create portable annotation resources using CompoundDb package. packages allows example create annotation databases MoNA, MassBank HMDB. CompDb annotations small compounds different resources become available also Bioconductors AnnotationHub. CompDb database containing compound annotations along (experimental) MS2 spectra provided data release MetaboAnnotationTutorials repository. download SQLite database temporary file. can now load annotation resource using CompDb function CompoundDb package: can now create Spectra object get access MS2 spectra within package: now Spectra object containing MS2 spectra HMDB along compound annotations. spectra variables (including compound annotations) available spectrum : Also , want filter data resource first spectra matching precursor m/z. Unfortunately, HMDB provided spectra’s precursor m/z hence need used containsMz function find spectra containing peak m/z matching m/z ion interest. addition, need use rather large tolerance value (defines maximal acceptable absolute difference m/z values) since experimental spectra HMDB seem recorded well calibrated instrument. total 3904 spectra contain peak required m/z (+/- 0.2 Dalton) can proceed calculate spectral similarities experimental spectra. highest similarity spectra spectra HMDB r max(res). compare two best matching spectra mirror plot, upper panel showing experimental spectrum lower panel best matching MS2 spectrum HMDB.  experimental spectrum seems nicely match reference MS2 HMDB. extract compound identifier best matching HMDB spectrum (stored spectra variable called \"compound_id\") name compound fact, matching spectrum HMDB experimental spectrum L-Cystine.","code":"#' Download the CompDb database using curl library(curl) dbname <- \"CompDb.Hsapiens.HMDB.5.0.sqlite\" db_file <- file.path(tempdir(), dbname) curl_download(     paste0(\"https://github.com/jorainer/MetaboAnnotationTutorials/\",            \"releases/download/2021-11-02/\", dbname),     destfile = db_file) library(CompoundDb) #' Load a CompDb database with compound annotation from HMDB cdb <- CompDb(db_file) cdb ## class: CompDb  ##  data source: HMDB  ##  version: 5.0  ##  organism: Hsapiens  ##  compound count: 217776  ##  MS/MS spectra count: 64920 hmdb <- Spectra(cdb) hmdb ## MSn data (Spectra) with 64920 spectra in a MsBackendCompDb backend: ##         msLevel precursorMz  polarity ##       <integer>   <numeric> <integer> ## 1            NA          NA         1 ## 2            NA          NA         1 ## 3            NA          NA         1 ## 4            NA          NA         1 ## 5            NA          NA         1 ## ...         ...         ...       ... ## 64916        NA          NA         0 ## 64917        NA          NA         0 ## 64918        NA          NA         0 ## 64919        NA          NA         0 ## 64920        NA          NA         1 ##  ... 32 more variables/columns. ##  Use  'spectraVariables' to list all of them. ##  data source: HMDB  ##  version: 5.0  ##  organism: Hsapiens spectraVariables(hmdb) ##  [1] \"msLevel\"                 \"rtime\"                   ##  [3] \"acquisitionNum\"          \"scanIndex\"               ##  [5] \"dataStorage\"             \"dataOrigin\"              ##  [7] \"centroided\"              \"smoothed\"                ##  [9] \"polarity\"                \"precScanNum\"             ## [11] \"precursorMz\"             \"precursorIntensity\"      ## [13] \"precursorCharge\"         \"collisionEnergy\"         ## [15] \"isolationWindowLowerMz\"  \"isolationWindowTargetMz\" ## [17] \"isolationWindowUpperMz\"  \"compound_id\"             ## [19] \"name\"                    \"inchi\"                   ## [21] \"inchikey\"                \"formula\"                 ## [23] \"exactmass\"               \"smiles\"                  ## [25] \"original_spectrum_id\"    \"predicted\"               ## [27] \"splash\"                  \"instrument_type\"         ## [29] \"instrument\"              \"spectrum_id\"             ## [31] \"msms_mz_range_min\"       \"msms_mz_range_max\"       ## [33] \"synonym\" #' Identify spectra containing a peak matching cystine m/z has_mz <- containsMz(hmdb, mz = mz, tolerance = 0.2) #' Subset HMDB hmdb_sub <- hmdb[has_mz] #' Compare HMDB against experimental spectra res <- compareSpectra(hmdb_sub, sps, tolerance = 0.2) best_match <- which(res == max(res), arr.ind = TRUE) ## Specifying a function to draw peak labels label_fun <- function(x) {     format(unlist(mz(x)), digits = 4) } plotSpectraMirror(hmdb_sub[best_match[1]], sps[best_match[2]], tolerance = 0.2,                   labels = label_fun, labelPos = 2, labelOffset = 0.2,                   labelSrt = -30) grid() hmdb_sub[best_match[1]]$compound_id ## [1] \"HMDB0000192\" hmdb_sub[best_match[1]]$name ## [1] \"L-Cystine\""},{"path":"https://jorainer.github.io/SpectraTutorials/articles/analyzing-MS-data-from-different-sources-with-Spectra.html","id":"an-alternative-way-to-store-ms-data","dir":"Articles","previous_headings":"Workshop","what":"An alternative way to store MS data","title":"Seamless Integration of Mass Spectrometry Data from Different Sources with the `Spectra` Package","text":"use cases might useful store data whole MS experiments central place. MsBackendSql backend allows example store data relational database, simple SQLite files MySQL/MariaDB database systems. latter case allow also remote access centrally stored data set. Also, performance, especially large datasets much better MySQL database compared SQLite database used . section show data MS experiment can inserted database can retrieved. create empty SQLite database (temporary file). detailed , SQL database system used instead (resulting eventually even better performance). can next import data example experiment selected database. MsBackendSql allows now access use MS data stored database. simply provide connection database parameter Spectra function use MsBackendSql backend. memory footprint Spectra object small data retrieved database --fly. performance backend also higher example MsBackendMzR. compare performance MsBackendSql present small data set MsBackendDataFrame (data -memory) MsBackendMzR (data retrieved original file). Thus, MsBackendSql similar performance data memory. performance even better smaller subsets data loaded. real world use case backend store large MS experiment central place. Data analysts connect central database, explore subset data ultimately either load subsets data (local) memory changing backend data subset e.g. MsBackendDataFrame store data subset local files e.g. mzML format using export method MsBackendMzR backend.","code":"library(RSQLite) scon <- dbConnect(SQLite(), tempfile()) library(MsBackendSql) ## Create a database containing the full raw data createMsBackendSqlDatabase(scon, fls) ## [1] TRUE sps_db <- Spectra(scon, source = MsBackendSql()) sps_db ## MSn data (Spectra) with 1578 spectra in a MsBackendSql backend: ##        msLevel precursorMz  polarity ##      <integer>   <numeric> <integer> ## 1            1          NA         1 ## 2            1          NA         1 ## 3            1          NA         1 ## 4            1          NA         1 ## 5            1          NA         1 ## ...        ...         ...       ... ## 1574         2    130.9659         1 ## 1575         2    175.1178         1 ## 1576         2    193.9281         1 ## 1577         2    107.9501         1 ## 1578         2     95.0608         1 ##  ... 34 more variables/columns. ##  Use  'spectraVariables' to list all of them. ## Database: /tmp/RtmpzswSNO/file67558dc2132 print(object.size(sps_db), units = \"MB\") ## 0.1 Mb ## Load the data to different backends sps_mzr <- Spectra(fls, source = MsBackendMzR()) sps_df <- setBackend(sps_mzr, MsBackendDataFrame())  library(microbenchmark) microbenchmark(peaksData(sps_mzr),                peaksData(sps_df),                peaksData(sps_db),                times = 10) ## Unit: milliseconds ##                expr      min       lq     mean   median       uq      max neval ##  peaksData(sps_mzr) 376.6548 400.5926 439.4055 427.9445 489.3848 532.3718    10 ##   peaksData(sps_df) 165.5719 173.7212 187.8967 179.4587 197.5205 223.0788    10 ##   peaksData(sps_db)  83.6108  95.8803 225.2520 101.5984 136.0746 710.4203    10 microbenchmark(peaksData(sps_mzr[1:10]),                peaksData(sps_df[1:10]),                peaksData(sps_db[1:10]),                times = 10) ## Unit: milliseconds ##                      expr     min      lq     mean   median      uq     max ##  peaksData(sps_mzr[1:10]) 15.5765 15.9336 17.05021 16.24525 17.0480 23.5515 ##   peaksData(sps_df[1:10])  6.6969  6.9653  7.39501  7.23905  7.2866  9.0349 ##   peaksData(sps_db[1:10])  4.9900  5.2460  5.56981  5.46370  5.9771  6.2384 ##  neval ##     10 ##     10 ##     10"},{"path":"https://jorainer.github.io/SpectraTutorials/articles/analyzing-MS-data-from-different-sources-with-Spectra.html","id":"short-summary","dir":"Articles","previous_headings":"","what":"Short summary","title":"Seamless Integration of Mass Spectrometry Data from Different Sources with the `Spectra` Package","text":"Spectra provides powerful infrastructure MS data. Independence data analysis data storage functionality allows easily add support additional data types data handling/storage modes. Caching data operations applying --fly allows data manipulations regardless data stored.","code":""},{"path":"https://jorainer.github.io/SpectraTutorials/articles/analyzing-MS-data-from-different-sources-with-Spectra.html","id":"summary","dir":"Articles","previous_headings":"","what":"Summary","title":"Seamless Integration of Mass Spectrometry Data from Different Sources with the `Spectra` Package","text":"simple use case matching experimental MS2 spectra public database illustrated short tutorial flexibility expandability Spectra package enables seamless integration mass spectrometry data different sources. possible clear separation user functionality (Spectra object) representation data (MsBackend object). Backends MsBackendMgf, MsBackendMassbank MsBackendHmdbXml provide support additional data formats data sources, others, due much lower memory footprint (MsBackendMzR, MsBackendHdf5Peaks), enable analysis also large data sets. importantly however, backends interchangeable affect way users can handle analyze MS data Spectra package. Also, caching data operations within Spectra object applying upon data requests, data operations can applied data resource regardless data stored, even data read-.","code":""},{"path":"https://jorainer.github.io/SpectraTutorials/articles/analyzing-MS-data-from-different-sources-with-Spectra.html","id":"what-else","dir":"Articles","previous_headings":"","what":"What else?","title":"Seamless Integration of Mass Spectrometry Data from Different Sources with the `Spectra` Package","text":"MetaboAnnotation (Andrea Vicini, Michael Witting) provide simple functions matching spectra m/z retention time data (Rainer et al. 2022). MsExperiment represent whole MS experiments (incl. Spectra, sample annotation, data quantitation, annotation files etc). msQC (Thomas Naake): QC measures MS data. MsBackendMsp (Steffen Neumann): backend files MSP format. ...","code":""},{"path":[]},{"path":"https://jorainer.github.io/SpectraTutorials/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Johannes Rainer. Author, maintainer. Michael Witting. Author. Laurent Gatto. Author. Sebastian Gibb. Author.","code":""},{"path":"https://jorainer.github.io/SpectraTutorials/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Rainer J, Witting M, Gatto L, Gibb S (2023). SpectraTutorials: Mass Spectrometry Data Analysis Spectra. R package version 0.7.2, https://jorainer.github.io/SpectraTutorials/.","code":"@Manual{,   title = {SpectraTutorials: Mass Spectrometry Data Analysis with Spectra},   author = {Johannes Rainer and Michael Witting and Laurent Gatto and Sebastian Gibb},   year = {2023},   note = {R package version 0.7.2},   url = {https://jorainer.github.io/SpectraTutorials/}, }"},{"path":"https://jorainer.github.io/SpectraTutorials/index.html","id":"mass-spectrometry-data-analysis-with-spectra","dir":"","previous_headings":"","what":"Mass Spectrometry Data Analysis with Spectra","title":"Mass Spectrometry Data Analysis with Spectra","text":"Tutorials workshops use Spectra Bioconductor package analyze mass spectrometry (MS) data.","code":""},{"path":[]},{"path":[]},{"path":"https://jorainer.github.io/SpectraTutorials/index.html","id":"short-description","dir":"","previous_headings":"Seamless Integration of Mass Spectrometry Data from Different Sources","what":"Short description","title":"Mass Spectrometry Data Analysis with Spectra","text":"workshop use Spectra : import MS data mzML files, select MS2 spectra certain compound, compare match MS2 spectra reference MS2 spectra public database, annotate spectra export file MGF format.","code":""},{"path":"https://jorainer.github.io/SpectraTutorials/index.html","id":"description","dir":"","previous_headings":"Seamless Integration of Mass Spectrometry Data from Different Sources","what":"Description","title":"Mass Spectrometry Data Analysis with Spectra","text":"(instructor-led live demo) workshop explains Spectra package shows new infrastructure can used represent analyze Mass Spectrometry (MS) data. use different data type format specific backends guarantees easy expandability infrastructure. illustrated tutorial simple use case, MS/MS (.k.. MS2) spectra, measured MS instrument, compared matched public spectral database containing public domain reference MS2 spectra. video recording workshop BioC2021 conference available . video recording workshop EuroBioc2020 conference available .","code":""},{"path":[]},{"path":"https://jorainer.github.io/SpectraTutorials/index.html","id":"learning-goals","dir":"","previous_headings":"Seamless Integration of Mass Spectrometry Data from Different Sources > Workshop goals and objectives","what":"Learning goals","title":"Mass Spectrometry Data Analysis with Spectra","text":"Understand import MS data R. Understand basic concept different backends can used Spectra work MS data various sources.","code":""},{"path":"https://jorainer.github.io/SpectraTutorials/index.html","id":"learning-objectives","dir":"","previous_headings":"Seamless Integration of Mass Spectrometry Data from Different Sources > Workshop goals and objectives","what":"Learning objectives","title":"Mass Spectrometry Data Analysis with Spectra","text":"Import export MS data Spectra. Integrate MS data different resources MS data analysis workflow. Apply different data manipulations MS data represented Spectra object. Use Spectra perform spectra comparisons R.","code":""},{"path":"https://jorainer.github.io/SpectraTutorials/index.html","id":"pre-requisites","dir":"","previous_headings":"Seamless Integration of Mass Spectrometry Data from Different Sources","what":"Pre-requisites","title":"Mass Spectrometry Data Analysis with Spectra","text":"Basic familiarity R Bioconductor. Basic understanding Mass Spectrometry (MS) data.","code":""},{"path":[]},{"path":"https://jorainer.github.io/SpectraTutorials/index.html","id":"docker-based-setup","dir":"","previous_headings":"Seamless Integration of Mass Spectrometry Data from Different Sources > Installation and participation","what":"Docker-based setup","title":"Mass Spectrometry Data Analysis with Spectra","text":"workshop available self-contained docker image simplifying installation usage. Get docker image tutorial docker pull jorainer/spectra_tutorials:latest. Start docker using Enter http://localhost:8787 web browser log username rstudio password bioc. Open R-markdown file (vignettes/analyzing-MS-data--different-sources--Spectra.Rmd) RStudio server version web browser evaluate R code blocks. get source code: clone github repository, e.g. git clone https://github.com/jorainer/SpectraTutorials.","code":"docker run \\     -e PASSWORD=bioc \\     -p 8787:8787 \\     jorainer/spectra_tutorials:latest"},{"path":"https://jorainer.github.io/SpectraTutorials/index.html","id":"manual-installation","dir":"","previous_headings":"Seamless Integration of Mass Spectrometry Data from Different Sources > Installation and participation","what":"Manual installation","title":"Mass Spectrometry Data Analysis with Spectra","text":"alternative, possible install required R packages locally R download SQLite database MassBank annotations required workshop. get source code: clone github repository, e.g. git   clone https://github.com/jorainer/SpectraTutorials. Install required R packages: Download SQLite database content MassBank .","code":"Sys.setenv(R_REMOTES_NO_ERRORS_FROM_WARNINGS=\"true\") install.packages(c(\"devtools\", \"rmarkdown\", \"BiocManager\")) BiocManager::install(c(\"BiocStyle\",                        \"MsCoreUtils\",                        \"Spectra\",                        \"pheatmap\",                        \"CompoundDb\",                        \"MsBackendMgf\",                        \"MsBackendMassbank\")) BiocManager::install(\"jorainer/SpectraTutorials\")"},{"path":"https://jorainer.github.io/SpectraTutorials/index.html","id":"manual-installation-with-available-mysql-database","dir":"","previous_headings":"Seamless Integration of Mass Spectrometry Data from Different Sources > Installation and participation","what":"Manual installation with available MySQL database","title":"Mass Spectrometry Data Analysis with Spectra","text":"advanced users also possible manually install resources required tutorial. addition R version >= 4, specifically examples involving MassBank database, running MySQL/MariaDB server also required. First install R packages detailed previous section. MySQL database dump MassBank database can downloaded official github page. database named MassBank created local MySQL/MariaDB server. downloaded .sql.gz needs unzipped can installed mysql MassBank < *.sql. source code tutorials package can downloaded : open R-markdown (Rmd) files one tutorials (located within vignettes folder editor choice (e.g. RStudio, emacs, vim, …) evaluate R-code tutorial interactively.","code":"git clone https://github.com/jorainer/SpectraTutorials"},{"path":"https://jorainer.github.io/SpectraTutorials/index.html","id":"rbioconductor-packages-used","dir":"","previous_headings":"Seamless Integration of Mass Spectrometry Data from Different Sources","what":"R/Bioconductor packages used","title":"Mass Spectrometry Data Analysis with Spectra","text":"Spectra MsCoreUtils MsBackendMgf MsBackendMassbank CompoundDb","code":""},{"path":[]},{"path":"https://jorainer.github.io/SpectraTutorials/index.html","id":"msms-spectra-matching-with-the-metaboannotation-package","dir":"","previous_headings":"","what":"MS/MS Spectra Matching with the MetaboAnnotation Package","title":"Mass Spectrometry Data Analysis with Spectra","text":"Spectra package provides functionality required annotation identification workflows untargeted LC-MS/MS data, , flexible customizable, might cumbersome beginners analysts accustomed R. fill gap developed MetaboAnnotation package builds upon Spectra provides functions annotation LC-MS LC-MS/MS data sets tailored towards less experienced R user. tutorial shows MetaboAnnotatio can used R-based LC-MS/MS annotation workflows. Note also additional tutorial MetaboAnnotation, CompoundDb MetaboCoreUtils packages available: MetaboAnnotationTutorials.","code":""},{"path":[]},{"path":"https://jorainer.github.io/SpectraTutorials/news/index.html","id":"version-0-7","dir":"Changelog","previous_headings":"","what":"Version 0.7.2","title":"Version 0.7","text":"Use MsBackendSql instead MsqlBackend.","code":""},{"path":"https://jorainer.github.io/SpectraTutorials/news/index.html","id":"version-0-7-1","dir":"Changelog","previous_headings":"","what":"Version 0.7.1","title":"Version 0.7","text":"Simplify/clarify description spectra data processing.","code":""},{"path":"https://jorainer.github.io/SpectraTutorials/news/index.html","id":"version-0-7-2","dir":"Changelog","previous_headings":"","what":"Version 0.7.0","title":"Version 0.7","text":"Add section use MsqlBackend compare performance MsBackendMzR MsBackendDataFrame.","code":""},{"path":[]},{"path":"https://jorainer.github.io/SpectraTutorials/news/index.html","id":"version-0-6","dir":"Changelog","previous_headings":"","what":"Version 0.6.3","title":"Version 0.6","text":"Better describe usage alternative SQLite MassBank database file two workshops.","code":""},{"path":"https://jorainer.github.io/SpectraTutorials/news/index.html","id":"version-0-6-1","dir":"Changelog","previous_headings":"","what":"Version 0.6.2","title":"Version 0.6","text":"Add citation.","code":""},{"path":"https://jorainer.github.io/SpectraTutorials/news/index.html","id":"version-0-6-2","dir":"Changelog","previous_headings":"","what":"Version 0.6.1","title":"Version 0.6","text":"Adapt changes Spectra >= 1.5.8: export spectraVariableMapping method. Adapt changes CompoundDb >= 0.9.6: \"target_name\" available spectra variable Spectra objects returned CompDb database. Adapt changes MetaboAnnotation >= 0.99.4: also ppm error reported matchMz.","code":""},{"path":"https://jorainer.github.io/SpectraTutorials/news/index.html","id":"version-0-6-3","dir":"Changelog","previous_headings":"","what":"Version 0.6.0","title":"Version 0.6","text":"Remove Spectra object data HMDB. Use CompDb database HMDB annotations.","code":""},{"path":[]},{"path":"https://jorainer.github.io/SpectraTutorials/news/index.html","id":"version-0-5","dir":"Changelog","previous_headings":"","what":"Version 0.5.0","title":"Version 0.5","text":"Add additional vignette describing spectra matching MetaboAnnotation package integration xcms analysis workflow.","code":""},{"path":[]},{"path":"https://jorainer.github.io/SpectraTutorials/news/index.html","id":"version-0-4","dir":"Changelog","previous_headings":"","what":"Version 0.4.0","title":"Version 0.4","text":"Version used BioC2021 conference. Use MassBank release 2021.03. Restructure document simplify analysis (reduce mzML files 20eV collision energy).","code":""},{"path":[]},{"path":"https://jorainer.github.io/SpectraTutorials/news/index.html","id":"version-0-3","dir":"Changelog","previous_headings":"","what":"Version 0.3.2","title":"Version 0.3","text":"Use MassBank release 2021.02 add expand descriptive text.","code":""}]
